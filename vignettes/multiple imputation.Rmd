---
title: "Multiple imputation"
author: "Michael Seo"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Multiple imputation}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  chunk_output_type: console
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

In this vignette, we describe how to impute missing data in individual patient data using multiple imputation. The package conveniently sets up correct input that are needed to use imputation method using mice, micemd, and miceadds packages. We will first introduce a mock dataset that we will use for illustration.

```{r}
#install.packages("bipd")
#or devtools::install_github("MikeJSeo/bipd")
library(bipd)
simulated_data <- generate_sysmiss_ipdma_example(Nstudies = 10, Ncov = 5, sys_missing_prob = 0.3, magnitude = 0.2, heterogeneity = 0.1)
dataset <- simulated_data$dataset
```

There is two types of missing data in individual patient data. 




```{r, eval = FALSE}
# If above doesn't work we can try by first find correct method and prediction matrix and
# then using ipdma.impute using these obtained objects. Through this process, we can check if there is any errors
# in setting up these objects.
missP <- findMissingPattern(mydata, covariates = c("baseline", "gender"), typeofvar = c("continuous", "binary"), 
                            studyname = "study",  treatmentname = "treat", outcomename = "y")
correctMeth <- getCorrectMeth(mydata, missP)
correctPred <- getCorrectPred(mydata, missP)
imputations_test <- ipdma.impute(mydata, covariates = c("baseline", "gender"), typeofvar = c("continuous", "binary"),
                             interaction = TRUE, meth = correctMeth, pred = correctPred,
                             studyname = "study", treatmentname = "treat", outcomename = "y")

```
